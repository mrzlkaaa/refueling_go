upstream refueling {
    server refuel:8888; #* put name of service + port
}

upstream diar {
    server diary:8889; #* put name of service + port
}

upstream proc {
    server processing:8890; #* put name of service + port
}

upstream generate_mcu {
    server mcu_generator:8891; #* put name of service + port
}

upstream auth {
    server security:8892; #* put name of service + port
}

server {
    listen 88;
    server_name refuel.nss-irt-t.xyz;
    client_max_body_size 20M;

    location /refuelings {
        proxy_pass http://refueling/refuelings;
    }
    location /add {
        proxy_pass http://refueling/add;
    }
}

server {
    listen 89;
    server_name diary.nss-irt-t.xyz;

    location /overallData {
        proxy_pass http://diar/overallData;
    }

    location ~* ^/weeksNum/(.*) {
        proxy_pass http://diar/weeksNum/$1;
    }

    location ~* ^/weekDetails/(.*)/(.*) {
        proxy_pass http://diar/weekDetails/$1/$2;
    }

    location /submitWeekData {
        proxy_pass http://diar/submitWeekData;
    }
    
}

server {
    listen 90;
    server_name auth.nss-irt-t.xyz;

    # add_header 'Access-Control-Allow-Origin' '*';
    # add_header 'Access-Control-Allow-Credentials' 'true';
    # add_header 'Access-Control-Allow-Headers' 'Authorization,Accept,Origin,DNT,X-CustomHeader,Keep-Alive,User-Agent,X-Requested-With,If-Modified-Since,Cache-Control,Content-Type,Content-Range,Range';
    # add_header 'Access-Control-Allow-Methods' 'GET,POST,OPTIONS,PUT,DELETE,PATCH';

    
    location /logout {
        proxy_pass http://auth/logout;
    }

    location ~* ^/users/(.*)/delete {
        proxy_pass http://auth/users/$1/delete;
    }

    location /users/update {
        proxy_pass http://auth/users/update;
    }

    location /getusers {
        proxy_pass http://auth/getusers;
    }

    location /register {
        proxy_pass http://auth/register;
    }
    
    location /login {
        proxy_pass http://auth/login;
    }

    location /refreshToken {
        proxy_pass http://auth/refreshToken;
    }
    
}

server {
    listen 8000;
    server_name proc.nss-irt-t.xyz;

    location /average {
        proxy_pass http://proc/average;
    }

    location /change {
        proxy_pass http://proc/change;
    }

    location /generateNoBurn {
        proxy_pass http://generate_mcu/generateNoBurn;
    }

    location /generateBurn {
        proxy_pass http://generate_mcu/generateBurn;
    }

}


# location ~* ^/refuelings/(.*)/delete {
#     proxy_pass http://refueling/$1/detail; 
# }
# location /upload_PDC {
#     proxy_pass http://python/upload_PDC; 
#     rewrite ^/upload_PDC?$ /reading_file break;
# }

# location /refuels {
#     proxy_pass http://front/refuels; 
#     # try_files $uri  /index.html;
# }

# location /reading_file {
#     proxy_pass http://python/reading_file; 
# }

# location /refueling {
#     proxy_pass http://python/refueling; 
# }

# location ~* ^/detail/(.*) {
#     proxy_pass http://python/detail/$1; 
# }

# location ~* ^/update/(.*) {
#     proxy_pass http://python/update/$1; 
# }

# location ~* ^/(.*)/delete {
#     proxy_pass http://python/$1/delete; 
# }

# location ~* ^/download/(.*) {
#     proxy_pass http://python/download/$1; 
